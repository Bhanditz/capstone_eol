- editable = collection.editable_by?(current_user)
- #TODO refer to older commit e.g. 5f64447fe0c1ac9b78c3 when need to reimplement editable actions and forms
#tabs_sidebar
  -#FIXME: active tab needs to be functional, and counts real, move to controller(?)
  %ul.tabs.with_icons
  
    - attrib = 'total'
    - attrib << ' active' if !params[:filter]
    %li{:class => attrib}= link_to I18n.t(:total_items_with_count, :count => @collection.collection_items.count), "/collections/#{params[:id]}/"
    
    - taxa_count = @collection.filter_type("taxa").compact.count
    - articles_count = @collection.filter_type("articles").compact.count
    - videos_count = @collection.filter_type("videos").compact.count
    - images_count = @collection.filter_type("images").compact.count
    - sounds_count = @collection.filter_type("sounds").compact.count
    - communities_count = @collection.filter_type("communities").compact.count
    - people_count = @collection.filter_type("people").compact.count
    - collections_count = @collection.filter_type("collections").compact.count

    - types = [{"count" => taxa_count,        "type" => "taxa",        "link" => "taxa_with_count"}, 
               {"count" => articles_count,    "type" => "articles",    "link" => "articles_with_count"},
               {"count" => videos_count,      "type" => "videos",      "link" => "videos_with_count"},
               {"count" => images_count,      "type" => "images",      "link" => "images_with_count"},
               {"count" => sounds_count,      "type" => "sounds",      "link" => "sounds_with_count"},
               {"count" => communities_count, "type" => "communities", "link" => "communities_with_count"},
               {"count" => people_count,      "type" => "people",      "link" => "people_with_count"},
               {"count" => collections_count, "type" => "collections", "link" => "collections_with_count"}]

    - types.each do |t|
      - attrib = t['type']
      - attrib << ' active' if params[:filter] == t['type']
      %li{:class => attrib}= link_to I18n.t(:"#{t['link']}", :count => t['count']), "/collections/#{params[:id]}/#{t['type']}"

  -#FIXME: Make this sort functional
  = render :partial => 'shared/sort_by_date_form'
#sidebar
  .collection_contributors
    %h3= I18n.t(:collected_by)
    %ul
      %li
        - if collection.community_id
          = link_to image_tag(collection.community.logo_url, :alt => ""), collection.community
          %h4= link_to collection.community.name, collection.community
        - elsif collection.user_id
          = link_to image_tag(collection.user.logo_url, :alt => ''), user_path(collection.user_id)
          %h4= link_to collection.user.full_name, user_path(collection.user_id)
          %p= collection.user.credentials

#collections.main_container
  - @collection_items.each do |item|
    = render :partial => 'collection_items/show', :locals => { :collection_item => item, :editable => editable }
  